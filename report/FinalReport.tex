\documentclass[10pt,a4paper]{article}

\usepackage{datetime}
\usepackage{numprint}
\usepackage{palatino}
\usepackage{authblk}
\usepackage[margin=0.75in]{geometry}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{listings}
\usepackage[english]{babel}
\usepackage[
	backend=biber,
	style=numeric,
]{biblatex}
\addbibresource{refs.bib}

\hypersetup{%
    pdfborder = {0 0 0}
}

\setlength{\parindent}{2em}
%\setlength{\parskip}{1em}
\renewcommand{\baselinestretch}{1.0}

\begin{document}

\nplpadding{2}

\title{Malware Analysis Report: ``Practical3.exe''\\ \vspace{-8pt} {\large CAP6137 Malware Reverse Engineering: P0x03}}
\author{{Naman Arora \\ \vspace{-10pt}\small \href{mailto:naman.arora@ufl.edu}{naman.arora@ufl.edu}}}
\date{\today}

\maketitle
\newpage
\tableofcontents
\newpage
\section{Executive Summary}
The provided binary has been identified as a member of \textit{Ryuk} family of \textit{Ransomwares} \cite{ransomware}.
This family of ransomwares gain access to victim systems via phishing \cite{phishing} or social engineering attacks \cite{socialEngg} and are known to be biased towards targeting commercial systems more as compared to personal systems.
\textit{FBI} warned against this campaign citing the malware authors as most profitable when compared to other authors of such malwares.
Also, this malware family is known to attack \textit{Windows} systems in general and \textit{Windows 10} systems in particular.

The malware binary itself is very small in size, around \textit{170 KB}, and has no significant obfuscation techniques built in.
Nevertheless, on dynamic analysis, the malware injects itself into common \textit{Windows} processes and installs a registry key to achieve persistance over reboots.
Any new file created or drive \textit{(for eg. USB etc.)} connected to the system is also targeted and encrypted.
Before any encryption happens, the malware,
\begin{itemize}
	\item Stops and kills multiple services and executables generally associated with commercial systems
	\item Enumerates all drives associated to the system and all the files within them.
\end{itemize}

The execution of malware is entirely offline and hence once infected, isolating the system from the network does not thwart its any malicious activities.
This also means that leaking of sensitive information from the infected system is highly improbable as a result of this infection.
After encryption, the malware installs multiple text files named \textit{RyukReadme.txt} acknowledging the data loss, stating the ransom and providing correspondence email and \textit{Bitcoin Wallet} addresses.
This ransomware family has, however, built up a reputation of consistently decrypting the data once ransom has been paid.

Independent analysis as well as aggregated opinion from the community very strongly suggests that decrypting the data without paying the ransom amount is not possible.
The cryptographic algorithms used for encryption are industry standard and hence extensively secure.
The prime recommendation would be to pay the ransom unless,
\begin{itemize}
	\item the data lost has been backed up and is tested to be recoverable to its fullest extent.
	\item the lost data cumulatively provides less value than ransom itself.
\end{itemize}

\newpage

\section{Static Analysis: Primary Executable}
	\subsection{Basic Identification}
	\subsection{Malware Sample Family Identification}
	\subsection{PE Sections}
	\subsection{A case for Packing}
	\subsection{Interesting Imports}

\section{Dynamic Analysis}
	\subsection{Network Based Analysis}
	\subsection{File System Based Analysis}

\newpage

\section{Indicators of Compromise}
	\subsection{Network Based}
	\subsection{Host Based}
	\subsection{\textit{YARA} Rule}
		Visit \cite{ghub} for rule file if copying fails.
		\lstinputlisting[language={},basicstyle=\tiny]{../rule.yar}

\newpage

\section{Appendix A: Screenshots}

\newpage

\printbibliography
\end{document}